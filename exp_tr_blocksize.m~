%% Ablation Studies for Texture Transfer
% Aman Kansal, Ansh Khurana, Kushagra Juneja

clc; clear; close all;
warning('off', 'all');

data_path = 'data/';
results_dir = 'results/bsize/';
texture_images = {'rice', 'fabric'};
content_images =  {'bill', 'girl'};


% show optimal results over iterations
B_choices=[10, 20, 30, 40];
B_decay_rate_choices = [0.9, 0.8, 0.7];
num_passes=5;
for ti = texture_images
    for ci = content_images
        t_path = fullfile(data_path, ti{1});
        c_path = fullfile(data_path, ci{1});
        tsize = size(T);
        show_inputs(t_path, c_path, results_dir, ti{1}, ci{1});
        for B_dr = B_decay_rate_choices
            B_res = zeros(length(B_choices), tsize(1), tsize(2), 3);
            for Bi = 1:length(B_choices)
                iter_res = transfer(t_path, c_path, B_choices(Bi), B_decay_rate, num_passes);
                res = squeeze(iter_res(num_passes, :, :, :));
                B_re
            end
        
        
        show_res_iter(iter_res, ti{1}, ci{1}, num_passes, B, B_decay_rate, results_dir);
    end
end
